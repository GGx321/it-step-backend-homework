# Express "Books & Users" API

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–Ω–∏–≥–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Express.js.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–Ω–∏–≥ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç–∞ API –∫–ª—é—á–æ–º
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ Rate limiting (60 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 5 –º–∏–Ω—É—Ç)
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–Ω–∏–≥ (–±–æ–Ω—É—Å)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
express-homework/
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app.js                  # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ books.routes.js     # –ú–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∫–Ω–∏–≥
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.routes.js     # –ú–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.js           # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requireApiKey.js    # –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ errorHandler.js     # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation.js       # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ data/
‚îÇ       ‚îú‚îÄ‚îÄ books.js            # –î–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥ (–≤ –ø–∞–º—è—Ç–∏)
‚îÇ       ‚îî‚îÄ‚îÄ users.js            # –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤ –ø–∞–º—è—Ç–∏)
```

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
npm start

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π)
npm run dev
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:5001`

## üìö API Endpoints

### Books API (`/api/books`)

#### GET /api/books
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `q` - –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ, case-insensitive)
- `page` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1)
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# –í—Å–µ –∫–Ω–∏–≥–∏ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
curl http://localhost:5001/api/books

# –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ —Å "node" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
curl "http://localhost:5001/api/books?q=node"

# –ü–∞–≥–∏–Ω–∞—Ü–∏—è
curl "http://localhost:5001/api/books?page=2&limit=3"

# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
curl "http://localhost:5001/api/books?q=node&page=1&limit=3"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "data": [...],
  "page": 1,
  "limit": 5,
  "total": 10
}
```

#### GET /api/books/:id
–ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É –ø–æ ID.

```bash
curl http://localhost:5001/api/books/1
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "id": 1,
  "title": "Clean Code",
  "author": "Robert Martin",
  "price": 25.5
}
```

**–û—à–∏–±–∫–∞ (404):**
```json
{
  "error": "Not Found",
  "message": "Book not found"
}
```

#### POST /api/books
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–Ω–∏–≥—É.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "title": "New Book",
  "author": "Author Name",
  "price": 29.99
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `title` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, —Å—Ç—Ä–æ–∫–∞, –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞
- `author` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–µ–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
- `price` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, —á–∏—Å–ª–æ > 0

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST http://localhost:5001/api/books \
  -H "Content-Type: application/json" \
  -d '{"title":"Test Book","author":"Test Author","price":19.99}'
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "id": 11,
  "title": "Test Book",
  "author": "Test Author",
  "price": 19.99
}
```

**–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400):**
```json
{
  "error": "ValidationError",
  "details": ["Title must be a string with at least 2 characters"]
}
```

#### PUT /api/books/:id
–û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É (—á–∞—Å—Ç–∏—á–Ω–æ –∏–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é).

```bash
curl -X PUT http://localhost:5001/api/books/1 \
  -H "Content-Type: application/json" \
  -d '{"price":27.99}'
```

#### DELETE /api/books/:id
–£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É.

```bash
curl -X DELETE http://localhost:5001/api/books/1
```

**–û—Ç–≤–µ—Ç (204):** –ù–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

#### GET /api/books/:id/recommendations (–ë–û–ù–£–°)
–ü–æ–ª—É—á–∏—Ç—å 3 –ø–æ—Ö–æ–∂–∏–µ –∫–Ω–∏–≥–∏.

```bash
curl http://localhost:5001/api/books/3/recommendations
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "book": "Node.js Design Patterns",
  "recommendations": [...]
}
```

---

### Users API (`/api/users`)

‚ö†Ô∏è **–í—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç API –∫–ª—é—á –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:**
```
x-api-key: SECRET123
```

#### GET /api/users
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `role` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏ (admin, user, moderator)

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
curl http://localhost:5001/api/users \
  -H "x-api-key: SECRET123"

# –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
curl "http://localhost:5001/api/users?role=admin" \
  -H "x-api-key: SECRET123"
```

**–ë–µ–∑ API –∫–ª—é—á–∞ (401):**
```json
{
  "error": "Unauthorized",
  "message": "Valid API key required"
}
```

#### GET /api/users/:id
–ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID.

```bash
curl http://localhost:5001/api/users/1 \
  -H "x-api-key: SECRET123"
```

#### POST /api/users
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "name": "New User",
  "email": "user@example.com",
  "role": "user"
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `name` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–µ–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
- `email` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å @
- `role` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "user")

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST http://localhost:5001/api/users \
  -H "Content-Type: application/json" \
  -H "x-api-key: SECRET123" \
  -d '{"name":"New User","email":"user@example.com"}'
```

#### PUT /api/users/:id
–û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```bash
curl -X PUT http://localhost:5001/api/users/1 \
  -H "Content-Type: application/json" \
  -H "x-api-key: SECRET123" \
  -d '{"role":"admin"}'
```

#### DELETE /api/users/:id
–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```bash
curl -X DELETE http://localhost:5001/api/users/1 \
  -H "x-api-key: SECRET123"
```

---

## üîß Middleware

### Logger
–õ–æ–≥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
[2025-10-16T14:32:18.015Z] GET /api/books 200 - 5ms
```

### API Key Protection
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `x-api-key: SECRET123` –¥–ª—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ `/api/users/*`.

### Validation
–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è POST –∏ PUT –æ–ø–µ—Ä–∞—Ü–∏–π.

### Error Handler
–ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—à–∏–±–∫–µ.

### Rate Limiting (–ë–û–ù–£–°)
–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ 60 –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç —Å –æ–¥–Ω–æ–≥–æ IP.

**–û—Ç–≤–µ—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ (429):**
```json
{
  "error": "Too Many Requests",
  "message": "Rate limit exceeded. Try again later."
}
```

---

## üìä –°—Ç–∞—Ç—É—Å-–∫–æ–¥—ã

- `200` - –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `201` - –†–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω
- `204` - –£—Å–ø–µ—à–Ω–æ, –Ω–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- `400` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω (–Ω–µ—Ç API –∫–ª—é—á–∞)
- `404` - –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `429` - –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- `500` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Health Check
```bash
curl http://localhost:5001/health
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "OK",
  "timestamp": "2025-10-16T14:32:18.015Z"
}
```

### –ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# 1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–Ω–∏–≥–∏
curl http://localhost:5001/api/books

# 2. –ü–æ–∏—Å–∫ –∫–Ω–∏–≥
curl "http://localhost:5001/api/books?q=node&page=1&limit=3"

# 3. –°–æ–∑–¥–∞—Ç—å –∫–Ω–∏–≥—É
curl -X POST http://localhost:5001/api/books \
  -H "Content-Type: application/json" \
  -d '{"title":"New Book","author":"Author","price":25.5}'

# 4. –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å API –∫–ª—é—á–æ–º)
curl http://localhost:5001/api/users \
  -H "x-api-key: SECRET123"

# 5. –§–∏–ª—å—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ä–æ–ª–∏
curl "http://localhost:5001/api/users?role=admin" \
  -H "x-api-key: SECRET123"

# 6. –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST http://localhost:5001/api/users \
  -H "Content-Type: application/json" \
  -H "x-api-key: SECRET123" \
  -d '{"name":"Test User","email":"test@example.com"}'

# 7. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–Ω–∏–≥
curl http://localhost:5001/api/books/3/recommendations

# 8. –¢–µ—Å—Ç 404
curl http://localhost:5001/api/unknown
```

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Express –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `express.json()`
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ä–æ—É—Ç–µ—Ä—ã –¥–ª—è books –∏ users
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `q` –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –∫–Ω–∏–≥
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ (POST/PUT)
- ‚úÖ Middleware –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ Middleware `requireApiKey` –¥–ª—è `/api/users/*`
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π `errorHandler`
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã (201, 404, 400, 500)

### –ë–æ–Ω—É—Å–Ω—ã–µ:
- ‚úÖ Rate limiting (60 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 5 –º–∏–Ω—É—Ç)
- ‚úÖ GET `/api/books/:id/recommendations`
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω–∞—è 404 –¥–ª—è API –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON

---

## üéì –ß—Ç–æ –∏–∑—É—á–µ–Ω–æ

- –°–æ–∑–¥–∞–Ω–∏–µ REST API –Ω–∞ Express
- –†–æ—É—Ç–∏–Ω–≥ –∏ –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- Middleware (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- Rate limiting
- HTTP —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã
- JSON API best practices
